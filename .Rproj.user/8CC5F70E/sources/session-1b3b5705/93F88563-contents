# penguins/plot.R

# reset the path
options(box.path = getwd())

# import prepped vars module
box::use(box/prep/vars)

# import ggplot2
box::use(
  ggplot2 = ggplot2[ggplot, aes, geom_point, 
                    facet_wrap, labs, theme_minimal]
)

#' @export
scatter <- function() {
  prepped <- vars$plot_vars()
  # plot prepped data
  plotted <- ggplot2$ggplot(data = prepped, 
    ggplot2$aes(
      x = flipper_length_mm,
      y = body_mass_g,
      group = sex
    )
  ) +
    ggplot2$geom_point(
      ggplot2$aes(color = island)
    ) +
    ggplot2$facet_wrap(. ~ sex) +
    ggplot2$labs(
      x = "Flipper Length (mm)", 
      y = "Body Mass (g)", 
      color = "Island",
      title = "Flipper vs. Body Mass", 
      subtitle = "Palmer Penguins"
    ) +
    ggplot2$theme_minimal()
  plotted
}