# penguins/plot.R

# reset the path
options(box.path = getwd())

# import plot vars module
box::use(box/prep/vars/plot)

# import ggplot2
box::use(
  ggplot2 = ggplot2[ggplot, aes, geom_point, 
                    facet_wrap, labs, theme_minimal]
)

#' @export
scatter <- function() {
  ggp2_vars <- plot$ggp2_vars()
  # plot prepped data
  ggp2_plot <- ggplot2$ggplot(data = ggp2_vars, 
    ggplot2$aes(
      x = flipper_length_mm,
      y = bill_length_mm,
      group = island
    )
  ) +
    ggplot2$geom_point(
      ggplot2$aes(color = species)
    ) +
    ggplot2$facet_wrap(. ~ island) +
    ggplot2$labs(
      x = "Flipper Length (mm)", 
      y = "Body Mass (g)", 
      color = "Island",
      title = "Flipper vs. Body Mass", 
      subtitle = "Palmer Penguins"
    ) +
    ggplot2$theme_minimal()
  ggp2_plot
}